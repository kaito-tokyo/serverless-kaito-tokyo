---
import fetchApi from "../../lib/strapi.js";
import type { NovelApp } from "../../interfaces/NovelApp.js";

export async function getStaticPaths() {
  const novelApps = await fetchApi<NovelApp[]>({
    endpoint: "novel-apps",
    wrappedByKey: "data",
  });

  return novelApps.map((app) => ({
    params: { slug: app.slug },
    props: app,
  }));
}
type Props = NovelApp;

const app = Astro.props;
const description = app.Description ?? "";
---

<!doctype html>
<html lang={app.Lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{app.Title}</title>
    <meta property="og:title" content={app.Title} />
    <meta property="og:description" content={description} />
    <meta
      property="og:image"
      content={`${new URL(`/novel-app/og/${app.slug}.png`, Astro.site).href}`}
    />
    <meta name="twitter:card" content="summary_large_image" />
    <Fragment set:html={app.Head} />
  </head>

  <body set:html={app.Body} />
</html>
